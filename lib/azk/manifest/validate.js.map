{"version":3,"file":"validate.js","sources":["../../../src/manifest/validate.js","@traceur/generated/TemplateParser/4","@traceur/generated/TemplateParser/0","@traceur/generated/TemplateParser/6","@traceur/generated/TemplateParser/7","@traceur/generated/TemplateParser/8","@traceur/generated/TemplateParser/9","@traceur/generated/TemplateParser/5","@traceur/generated/TemplateParser/1","@traceur/generated/TemplateParser/2"],"names":[],"mappings":"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","sourcesContent":["import { _ } from 'azk';\n\nexport class Validate {\n  static analyze(manifest) {\n    var errors = [];\n\n    // validates\n    errors = errors.concat(\n      this._have_systems(manifest),\n      this._have_old_volumes(manifest)\n    );\n\n    return errors;;\n  }\n\n  static _have_systems(manifest) {\n    if (_.isEmpty(_.keys(manifest.systems))) {\n      return [this._warning('not_systems', manifest)];\n    }\n    return [];\n  }\n\n  static _have_old_volumes(manifest) {\n    return _.reduce(manifest.systems, (errors, system) => {\n      if (\n        !_.isEmpty(system.options.mount_folders) ||\n        !_.isEmpty(system.options.persistent_folders)\n      ) {\n        errors.push(this._deprecate(\"old_volumes\", manifest, {\n          system: system.name,\n        }));\n      }\n      return errors;\n    }, []);\n  }\n\n  static _deprecate(...args) {\n    return this._entry('deprecate', ...args);\n  }\n\n  static _warning(...args) {\n    return this._entry('warning', ...args);\n  }\n\n  static _error(...args) {\n    return this._entry('error', ...args);\n  }\n\n  static _entry(level, key, manifest, data = {}) {\n    return _.merge(data, { level, key, manifest });\n  }\n}\n","var __moduleName = $__placeholder__0;","require($__placeholder__0)","var $__placeholder__0 = $__placeholder__1","($traceurRuntime.createClass)($__placeholder__0, $__placeholder__1, $__placeholder__2)","\n            for (var $__placeholder__0 = [], $__placeholder__1 = 0;\n                 $__placeholder__2 < arguments.length; $__placeholder__3++)\n              $__placeholder__4[$__placeholder__5] = arguments[$__placeholder__6];","$traceurRuntime.spread($__placeholder__0)","module.exports = $__placeholder__0;","get $__placeholder__0() { return $__placeholder__1; }","__esModule: true"]}