{"version":3,"file":"docker.js","sources":["../../../src/cmds/docker.js","@traceur/generated/TemplateParser/4","@traceur/generated/TemplateParser/0","@traceur/generated/TemplateParser/7","@traceur/generated/TemplateParser/6","@traceur/generated/TemplateParser/9","@traceur/generated/TemplateParser/8","@traceur/generated/TemplateParser/18","@traceur/generated/TemplateParser/10","@traceur/generated/TemplateParser/17","@traceur/generated/TemplateParser/13","@traceur/generated/TemplateParser/14","@traceur/generated/TemplateParser/11","@traceur/generated/TemplateParser/12","@traceur/generated/TemplateParser/15","@traceur/generated/TemplateParser/16","@traceur/generated/TemplateParser/5","@traceur/generated/TemplateParser/1","@traceur/generated/TemplateParser/2"],"names":[],"mappings":"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","sourcesContent":["import { _, path, async, defer, log, config, utils } from 'azk';\nimport { Command, Helpers } from 'azk/cli/command';\nimport { Manifest } from 'azk/manifest';\n\nclass Cmd extends Command {\n  get docker() {\n    return require('azk/docker').default;\n  }\n\n  run_docker(opts) {\n    return defer((resolve, reject) => {\n      var args = _.map(process.argv.slice(3), (arg) => {\n        return arg.match(/^.* .*$/) ? `\\\\\"${arg}\\\\\"` : arg;\n      });\n\n      if (!config('agent:requires_vm')) {\n        var cmd   = `/bin/sh -c \"docker ${args.join(\" \")}\"`;\n      } else {\n        var point = config('agent:vm:mount_point') + '.nfs';\n        var _path = utils.docker.resolvePath(this.cwd, point);\n        var cmd   = `azk vm ssh -t \"cd ${_path}; docker ${args.join(\" \")}\"`;\n      }\n\n      log.debug(\"docker options: %s\", cmd);\n      this.execSh(cmd, (err) => {\n        resolve((err) ? err.code : 0);\n      });\n    });\n  }\n\n  action(opts) {\n    return async(this, function* () {\n      if (config('agent:requires_vm')) {\n        yield Helpers.requireAgent();\n      }\n      return yield this.run_docker(opts);\n    });\n  }\n}\n\nexport function init(cli) {\n  return (new Cmd('docker [*dockerargs]', cli))\n}\n\n","var __moduleName = $__placeholder__0;","require($__placeholder__0)","var $__placeholder__0 = $__placeholder__1","$traceurRuntime.defaultSuperCall(this,\n                $__placeholder__0.prototype, arguments)","var $__placeholder__0 = $__placeholder__1","($traceurRuntime.createClass)($__placeholder__0, $__placeholder__1, $__placeholder__2,\n                                       $__placeholder__3)","return $__placeholder__0(\n            $__placeholder__1,\n            this);","$traceurRuntime.generatorWrap","function($ctx) {\n      while (true) $__placeholder__0\n    }","$ctx.state = ($__placeholder__0) ? $__placeholder__1 : $__placeholder__2;\n        break","return $__placeholder__0","$ctx.maybeThrow()","$ctx.sent","$ctx.returnValue = $__placeholder__0","return $ctx.end()","module.exports = $__placeholder__0;","get $__placeholder__0() { return $__placeholder__1; }","__esModule: true"]}